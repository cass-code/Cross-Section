g <-
ggplot(data = dfplot,aes(x = education, y = income)) +
geom_point() +
stat_smooth(method = "lm",
col = "#C42126",
se = FALSE,
size = 1) +
theme_minimal()+
# theme(legend.position = "none") +
xlab("Education") +
ylab("Income") +
ggtitle("Plot of Income and Education")
g
g <-
ggplot(data = dfplot,aes(x = education, y = income)) +
geom_point(fill=income) +
stat_smooth(method = "lm",
col = "#C42126",
se = FALSE,
size = 1) +
theme_minimal()+
# theme(legend.position = "none") +
xlab("Education") +
ylab("Income") +
ggtitle("Plot of Income and Education")
g <-
ggplot(data = dfplot,aes(x = education, y = income)) +
geom_point(fill=education) +
stat_smooth(method = "lm",
col = "#C42126",
se = FALSE,
size = 1) +
theme_minimal()+
# theme(legend.position = "none") +
xlab("Education") +
ylab("Income") +
ggtitle("Plot of Income and Education")
g <-
ggplot(data = dfplot,aes(x = education, y = income, fill=education)) +
geom_point() +
stat_smooth(method = "lm",
col = "#C42126",
se = FALSE,
size = 1) +
theme_minimal()+
# theme(legend.position = "none") +
xlab("Education") +
ylab("Income") +
ggtitle("Plot of Income and Education")
g
g <-
ggplot(data = dfplot,aes(x = education, y = income, fill=income)) +
geom_point() +
stat_smooth(method = "lm",
col = "#C42126",
se = FALSE,
size = 1) +
theme_minimal()+
# theme(legend.position = "none") +
xlab("Education") +
ylab("Income") +
ggtitle("Plot of Income and Education")
g
g <-
ggplot(data = dfplot,aes(x = education, y = income, color=cyl)) +
geom_point() +
stat_smooth(method = "lm",
col = "#C42126",
se = FALSE,
size = 1) +
theme_minimal()+
# theme(legend.position = "none") +
xlab("Education") +
ylab("Income") +
ggtitle("Plot of Income and Education")
g
g <-
ggplot(data = dfplot,aes(x = education, y = income, color=race)) +
geom_point() +
stat_smooth(method = "lm",
col = "#C42126",
se = FALSE,
size = 1) +
theme_minimal()+
# theme(legend.position = "none") +
xlab("Education") +
ylab("Income") +
ggtitle("Plot of Income and Education")
g
g <-
ggplot(data = dfplot,aes(x = education, y = income, color=race)) +
geom_point() +
stat_smooth(method = "lm",
col = "#FFFFFF",
se = FALSE,
size = 1) +
theme_minimal()+
# theme(legend.position = "none") +
xlab("Education") +
ylab("Income") +
ggtitle("Plot of Income and Education")
g
g <-
ggplot(data = dfplot,aes(x = education, y = income, color=race)) +
geom_point() +
stat_smooth(method = "lm",
col = "#000000",
se = FALSE,
size = 1) +
theme_minimal()+
# theme(legend.position = "none") +
xlab("Education") +
ylab("Income") +
ggtitle("Plot of Income and Education")
g
list.files('code/', full.names = T, recursive = T) %>% as.list() %>% walk(~source(.))
data <- read_dta("data/Adult_W5_Anon_V1.0.0.dta")
data <- read_dta("data/Adult_W5_Anon_V1.0.0.dta")
w4 <- read_dta("data/Adult_W4_Anon_V2.0.0.dta")
df1 <- reg1_clean(data)
b <- iv1_clean4(w4)
df2 <- reg2_clean(data)
df2 <- reg2_clean(data)
dfiv <- iv1_clean(data)
lm1 <-lm(income ~ age+ age2+ school + tertiary, dfiv)
lm2 <-lm(income ~ age+ age2+ school+tertiary + race + gender, dfiv)
iv1 <- ivreg(income ~ age + age2 | school + tertiary | father_ed + father_tert, data = dfiv)
iv2 <- ivreg(income ~ age + age2 + race + gender| school + tertiary | father_ed + father_tert, data = dfiv)
library(huxtable)
Title <- "Regression Output"
Label <- "Reg01"
htab <-
huxreg(lm1 = "OLS 1",lm2 = "OLS 2", iv1 = "2SLS 1", iv2 = "2SLS 2",
statistics = c(N = "nobs", R2 = "r.squared"),
note = "%stars%.") %>%
set_caption(Title) %>%
set_label(Label)
dfiv <- iv1_clean(data)
lm1 <-lm(income ~ age+ age2+ school + tertiary, dfiv)
lm2 <-lm(income ~ age+ age2+ school+tertiary + race + gender, dfiv)
iv1 <- ivreg(income ~ age + age2 | school + tertiary | father_ed + father_tert, data = dfiv)
iv2 <- ivreg(income ~ age + age2 + race + gender| school + tertiary | father_ed + father_tert, data = dfiv)
htab <-
huxreg(lm1 = "OLS 1",lm2 = "OLS 2", iv1 = "2SLS 1", iv2 = "2SLS 2",
statistics = c(N = "nobs", R2 = "r.squared"),
note = "%stars%.") %>%
set_caption(Title) %>%
set_label(Label)
htab <-
# huxreg(lm1 = "OLS 1",lm2 = "OLS 2", iv1 = "2SLS 1", iv2 = "2SLS 2",
huxreg(lm1,lm2, iv1, iv2,
statistics = c(N = "nobs", R2 = "r.squared"),
note = "%stars%.") %>%
set_caption(Title) %>%
set_label(Label)
htab
htab <-
# huxreg(lm1 = "OLS 1",lm2 = "OLS 2", iv1 = "2SLS 1", iv2 = "2SLS 2",
huxreg("OLS 1" = lm1,lm2, iv1, iv2,
statistics = c(N = "nobs", R2 = "r.squared"),
note = "%stars%.") %>%
set_caption(Title) %>%
set_label(Label)
htab
htab <-
# huxreg(lm1 = "OLS 1",lm2 = "OLS 2", iv1 = "2SLS 1", iv2 = "2SLS 2",
huxreg("OLS 1" = lm1, "OLS 2" = lm2, "2SLS 1" = iv1, "2SLS 2" = iv2,
statistics = c(N = "nobs", R2 = "r.squared"),
note = "%stars%.") %>%
set_caption(Title) %>%
set_label(Label)
font_size(htab) <- 12
htab
![]("Tex/conclusion.jpg")
View(data)
source("code/basic_clean.R")
clean <- basic_clean(data)
iv1<- clean %>% select(income, age, age2, school, gender, tertiary, race, mother_schl, mother_tert) %>% filter(income >0 & age>0 & school>=0 & tertiary>=0 & mother_schl >=0 & mother_tert >=0 & race<= 4 & race >=1) %>%
mutate(income = replace(income, income > 0, log(income))) %>%
dplyr::mutate(mother_tert = replace_na(mother_tert, 0)) %>%
mutate(school = replace(school, school >=0, school +1)) %>%
mutate(school = replace(school, school ==26, 0)) %>%
mutate(mother_schl = replace(mother_schl, mother_schl >=0, mother_schl +1)) %>%
mutate(mother_schl = replace(mother_schl, mother_schl ==26, 0)) %>%
mutate(mother_tert = replace(mother_tert, mother_tert ==2, 0)) %>%
mutate(tertiary = replace(tertiary, tertiary >1, 0)) %>%
mutate(education = school + tertiary) %>%
mutate(gender = replace(gender, gender == 2, "Female")) %>%
mutate(gender = replace(gender, gender == 1, "Male")) %>%
mutate(mother_ed = mother_schl + mother_tert) %>%
mutate(race = replace(race, race == 1, "African")) %>% mutate(race = replace(race, race == 2, "Coloured")) %>%
mutate(race = replace(race, race == 3, "Asian/Indian")) %>% mutate(race = replace(race, race == 4, "White")) %>%
filter(education >=0 & education <=14) %>%  as.data.frame()
cor(iv1$education, iv1$mother_ed, method = "pearson")
View(iv1)
cor(iv1$school, iv1$mother_schl, method = "pearson")
cor(iv1$tertiary, iv1$mother_tert, method = "pearson")
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, fig.width = 6, fig.height = 5, fig.pos="H", fig.pos = 'H')
if(!require("tidyverse")) install.packages("tidyverse")
library(tidyverse)
list.files('code/', full.names = T, recursive = T) %>% as.list() %>% walk(~source(.))
dfiv <- iv1_mother(data)
dfiv <- iv_mother(data)
lm1 <-lm(income ~ age+ age2+ school + tertiary, dfiv)
lm1 <-lm(income ~ age+ age2+ school + tertiary, dfiv)
lm2 <-lm(income ~ age+ age2+ school+tertiary + race + gender, dfiv)
iv1 <- ivreg(income ~ age + age2 | school + tertiary | mother_ed + mother_tert, data = dfiv)
lm2 <-lm(income ~ age+ age2+ school+tertiary + race + gender, dfiv)
iv1 <- ivreg(income ~ age + age2 | school + tertiary | mother_ed + mother_tert, data = dfiv)
iv2 <- ivreg(income ~ age + age2 + race + gender| school + tertiary | mother_ed + mother_tert, data = dfiv)
Title <- "Regressions: Mother Education Instrument"
htab <-
# huxreg(lm1 = "OLS 1",lm2 = "OLS 2", iv1 = "2SLS 1", iv2 = "2SLS 2",
huxreg("OLS 1" = lm1, "OLS 2" = lm2, "2SLS 1" = iv1, "2SLS 2" = iv2,
statistics = c(N = "nobs", R2 = "r.squared"),
note = "%stars%.") %>%
set_caption(Title) %>%
set_label(Label)
htab <-
# huxreg(lm1 = "OLS 1",lm2 = "OLS 2", iv1 = "2SLS 1", iv2 = "2SLS 2",
huxreg("OLS 1" = lm1, "OLS 2" = lm2, "2SLS 1" = iv1, "2SLS 2" = iv2,
statistics = c(N = "nobs", R2 = "r.squared"),
note = "%stars%.") %>%
set_caption(Title) %>%
set_label(Label)
font_size(htab) <- 12
htab
list.files('code/', full.names = T, recursive = T) %>% as.list() %>% walk(~source(.))
dfiv <- iv1_clean(data)
lm1 <-lm(income ~ age+ age2+ school + tertiary, dfiv)
lm2 <-lm(income ~ age+ age2+ school+tertiary + race + gender, dfiv)
iv1 <- ivreg(income ~ age + age2 | school + tertiary | father_ed + father_tert, data = dfiv)
iv2 <- ivreg(income ~ age + age2 + race + gender| school + tertiary | father_ed + father_tert, data = dfiv)
library(huxtable)
Title <- "Regressions: Father Education Instrument"
Label <- "reg1"
htab <-
huxreg("OLS 1" = lm1, "2SLS 1" = iv1, "OLS 2" = lm2,  "2SLS 2" = iv2,
statistics = c(N = "nobs", R2 = "r.squared"),
note = "%stars%.") %>%
set_caption(Title) %>%
set_label(Label)
font_size(htab) <- 12
htab
list.files('code/', full.names = T, recursive = T) %>% as.list() %>% walk(~source(.))
dfiv <- iv_mother(data)
lm1 <-lm(income ~ age+ age2+ school + tertiary, dfiv)
lm2 <-lm(income ~ age+ age2+ school+tertiary + race + gender, dfiv)
iv1 <- ivreg(income ~ age + age2 | school + tertiary | mother_ed + mother_tert, data = dfiv)
iv2 <- ivreg(income ~ age + age2 + race + gender| school + tertiary | mother_ed + mother_tert, data = dfiv)
library(huxtable)
Title <- "Regressions: Mother Education Instrument"
Label <- "reg2"
htab <-
# huxreg(lm1 = "OLS 1",lm2 = "OLS 2", iv1 = "2SLS 1", iv2 = "2SLS 2",
huxreg("OLS 1" = lm1, "2SLS 1" = iv1, "OLS 2" = lm2, , "2SLS 2" = iv2,
statistics = c(N = "nobs", R2 = "r.squared"),
note = "%stars%.") %>%
set_caption(Title) %>%
set_label(Label)
htab <-
huxreg("OLS 1" = lm1, "2SLS 1" = iv1, "OLS 2" = lm2, "2SLS 2" = iv2,
statistics = c(N = "nobs", R2 = "r.squared"),
note = "%stars%.") %>%
set_caption(Title) %>%
set_label(Label)
font_size(htab) <- 12
htab
dfiv <- iv1_clean(data)
lm1 <-lm(income ~ age+ age2+ school + tertiary, dfiv)
lm2 <-lm(income ~ age+ age2+ school+tertiary + race + gender, dfiv)
iv1 <- ivreg(income ~ age + age2 | school + tertiary | father_schl + father_tert, data = dfiv)
iv2 <- ivreg(income ~ age + age2 + race + gender| school + tertiary | father_ed + father_tert, data = dfiv)
library(huxtable)
Title <- "Regressions: Father Education Instrument"
Label <- "reg1"
htab <-
huxreg("OLS 1" = lm1, "2SLS 1" = iv1, "OLS 2" = lm2,  "2SLS 2" = iv2,
statistics = c(N = "nobs", R2 = "r.squared"),
note = "%stars%.") %>%
set_caption(Title) %>%
set_label(Label)
font_size(htab) <- 12
htab
dfiv <- iv1_clean(data)
lm1 <-lm(income ~ age+ age2+ school + tertiary, dfiv)
lm2 <-lm(income ~ age+ age2+ school+tertiary + race + gender, dfiv)
iv1 <- ivreg(income ~ age + age2 | school + tertiary | father_schl + father_tert, data = dfiv)
iv2 <- ivreg(income ~ age + age2 + race + gender| school + tertiary | father_schl + father_tert, data = dfiv)
library(huxtable)
Title <- "Regressions: Father Education Instrument"
Label <- "reg1"
htab <-
huxreg("OLS 1" = lm1, "2SLS 1" = iv1, "OLS 2" = lm2,  "2SLS 2" = iv2,
statistics = c(N = "nobs", R2 = "r.squared"),
note = "%stars%.") %>%
set_caption(Title) %>%
set_label(Label)
font_size(htab) <- 12
htab
dfiv <- iv_mother(data)
lm1 <-lm(income ~ age+ age2+ school + tertiary, dfiv)
lm2 <-lm(income ~ age+ age2+ school+tertiary + race + gender, dfiv)
iv1 <- ivreg(income ~ age + age2 | school + tertiary | mother_schl + mother_tert, data = dfiv)
iv2 <- ivreg(income ~ age + age2 + race + gender| school + tertiary | mother_schl + mother_tert, data = dfiv)
library(huxtable)
Title <- "Regressions: Mother Education Instrument"
Label <- "reg2"
htab <-
huxreg("OLS 1" = lm1, "2SLS 1" = iv1, "OLS 2" = lm2, "2SLS 2" = iv2,
statistics = c(N = "nobs", R2 = "r.squared"),
note = "%stars%.") %>%
set_caption(Title) %>%
set_label(Label)
font_size(htab) <- 12
htab
#iv1 <- ivreg(income ~ age + age2 | school + tertiary | mother_schl + mother_tert, data = dfiv)
iv1 <- ivreg(income ~ age + age2 | education | mother_ed, data = dfiv)
iv2 <- ivreg(income ~ age + age2 + race + gender| education | mother_ed, data = dfiv)
dfiv <- iv_mother(data)
# lm1 <-lm(income ~ age+ age2+ school + tertiary, dfiv)
# lm2 <-lm(income ~ age+ age2+ school+tertiary + race + gender, dfiv)
lm1 <-lm(income ~ age+ age2+ education, dfiv)
lm2 <-lm(income ~ age+ age2+ education + race + gender, dfiv)
#iv1 <- ivreg(income ~ age + age2 | school + tertiary | mother_schl + mother_tert, data = dfiv)
iv1 <- ivreg(income ~ age + age2 | education | mother_ed, data = dfiv)
iv2 <- ivreg(income ~ age + age2 + race + gender| education | mother_ed, data = dfiv)
#iv2 <- ivreg(income ~ age + age2 + race + gender| school + tertiary | mother_schl + mother_tert, data = dfiv)
library(huxtable)
Title <- "Regressions: Mother Education Instrument"
Label <- "reg2"
htab <-
huxreg("OLS 1" = lm1, "2SLS 1" = iv1, "OLS 2" = lm2, "2SLS 2" = iv2,
statistics = c(N = "nobs", R2 = "r.squared"),
note = "%stars%.") %>%
set_caption(Title) %>%
set_label(Label)
font_size(htab) <- 12
htab
source("code/basic_clean.R")
clean <- basic_clean(data)
View(clean)
iv1<- clean %>% select(income, age, age2, school, gender, tertiary, race, mother_occ) %>% filter(income >0 & age>0 & school>=0 & tertiary>=0 & mother_occ >=0 & race<= 4 & race >=1) %>%
mutate(income = replace(income, income > 0, log(income))) %>%
mutate(school = replace(school, school >=0, school +1)) %>%
mutate(school = replace(school, school ==26, 0)) %>%
mutate(tertiary = replace(tertiary, tertiary >1, 0)) %>%
mutate(education = school + tertiary) %>%
mutate(gender = replace(gender, gender == 2, "Female")) %>%
mutate(gender = replace(gender, gender == 1, "Male")) %>%
mutate(race = replace(race, race == 1, "African")) %>% mutate(race = replace(race, race == 2, "Coloured")) %>%
mutate(race = replace(race, race == 3, "Asian/Indian")) %>% mutate(race = replace(race, race == 4, "White")) %>%
filter(education >=0 & education <=14) %>%
as.data.frame()
View(clean)
View(iv1)
iv1<- clean %>% select(income, age, age2, school, gender, tertiary, race, mother_occ) %>% filter(income >0 & age>0 & school>=0 & tertiary>=0 & mother_occ >=0 & race<= 4 & race >=1) %>%
mutate(income = replace(income, income > 0, log(income))) %>%
mutate(school = replace(school, school >=0, school +1)) %>%
mutate(school = replace(school, school ==26, 0)) %>%
mutate(tertiary = replace(tertiary, tertiary >1, 0)) %>%
mutate(education = school + tertiary) %>%
mutate(gender = replace(gender, gender == 2, "Female")) %>%
mutate(gender = replace(gender, gender == 1, "Male")) %>%
mutate(race = replace(race, race == 1, "African")) %>% mutate(race = replace(race, race == 2, "Coloured")) %>%
mutate(race = replace(race, race == 3, "Asian/Indian")) %>% mutate(race = replace(race, race == 4, "White")) %>%
filter(education >=0 & education <=14) %>%
mutate(mother_occ = replace(mother_occ, race == 1, "Legislators/Managers")) %>% mutate(mother_occ = replace(mother_occ, race == 2, "Professionals")) %>%
mutate(mother_occ = replace(mother_occ, race == 3, "Technicians & Associate Professionals")) %>% mutate(mother_occ = replace(mother_occ, race == 4, "Clerks")) %>%
mutate(mother_occ = replace(mother_occ, race == 5, "Service Workers")) %>% mutate(mother_occ = replace(mother_occ, race ==6 , "Agriculture")) %>%
mutate(mother_occ = replace(mother_occ, race ==7 , "Craft/Trade")) %>% mutate(mother_occ = replace(mother_occ, race == 8, "Machine Operators")) %>%
mutate(mother_occ = replace(mother_occ, race == 9, "Elementary")) %>%
as.data.frame()
View(iv1)
iv1<- clean %>% select(income, age, age2, school, gender, tertiary, race, mother_occ) %>% filter(income >0 & age>0 & school>=0 & tertiary>=0 & mother_occ >=0 & race<= 4 & race >=1) %>%
mutate(income = replace(income, income > 0, log(income))) %>%
mutate(school = replace(school, school >=0, school +1)) %>%
mutate(school = replace(school, school ==26, 0)) %>%
mutate(tertiary = replace(tertiary, tertiary >1, 0)) %>%
mutate(education = school + tertiary) %>%
mutate(gender = replace(gender, gender == 2, "Female")) %>%
mutate(gender = replace(gender, gender == 1, "Male")) %>%
mutate(race = replace(race, race == 1, "African")) %>% mutate(race = replace(race, race == 2, "Coloured")) %>%
mutate(race = replace(race, race == 3, "Asian/Indian")) %>% mutate(race = replace(race, race == 4, "White")) %>%
filter(education >=0 & education <=14) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 1, "Legislators/Managers")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 2, "Professionals")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 3, "Technicians & Associate Professionals")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 4, "Clerks")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 5, "Service Workers")) %>% mutate(mother_occ = replace(mother_occ, mother_occ ==6 , "Agriculture")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ ==7 , "Craft/Trade")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 8, "Machine Operators")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 9, "Elementary")) %>%
iv1<- clean %>% select(income, age, age2, school, gender, tertiary, race, mother_occ) %>% filter(income >0 & age>0 & school>=0 & tertiary>=0 & mother_occ >=0 & race<= 4 & race >=1) %>%
mutate(income = replace(income, income > 0, log(income))) %>%
mutate(school = replace(school, school >=0, school +1)) %>%
mutate(school = replace(school, school ==26, 0)) %>%
mutate(tertiary = replace(tertiary, tertiary >1, 0)) %>%
mutate(education = school + tertiary) %>%
mutate(gender = replace(gender, gender == 2, "Female")) %>%
mutate(gender = replace(gender, gender == 1, "Male")) %>%
mutate(race = replace(race, race == 1, "African")) %>% mutate(race = replace(race, race == 2, "Coloured")) %>%
mutate(race = replace(race, race == 3, "Asian/Indian")) %>% mutate(race = replace(race, race == 4, "White")) %>%
filter(education >=0 & education <=14) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 1, "Legislators/Managers")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 2, "Professionals")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 3, "Technicians & Associate Professionals")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 4, "Clerks")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 5, "Service Workers")) %>% mutate(mother_occ = replace(mother_occ, mother_occ ==6 , "Agriculture")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ ==7 , "Craft/Trade")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 8, "Machine Operators")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 9, "Elementary")) %>%
as.data.frame()
iv1<- clean %>% select(income, age, age2, school, gender, tertiary, race, mother_occ) %>% filter(income >0 & age>0 & school>=0 & tertiary>=0 & mother_occ >=0 & race<= 4 & race >=1) %>%
mutate(income = replace(income, income > 0, log(income))) %>%
mutate(school = replace(school, school >=0, school +1)) %>%
mutate(school = replace(school, school ==26, 0)) %>%
mutate(tertiary = replace(tertiary, tertiary >1, 0)) %>%
mutate(education = school + tertiary) %>%
mutate(gender = replace(gender, gender == 2, "Female")) %>%
mutate(gender = replace(gender, gender == 1, "Male")) %>%
mutate(race = replace(race, race == 1, "African")) %>% mutate(race = replace(race, race == 2, "Coloured")) %>%
mutate(race = replace(race, race == 3, "Asian/Indian")) %>% mutate(race = replace(race, race == 4, "White")) %>%
filter(education >=0 & education <=14) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 1, "Legislators/Managers")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 2, "Professionals")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 3, "Technicians & Associate Professionals")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 4, "Clerks")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 5, "Service Workers")) %>% mutate(mother_occ = replace(mother_occ, mother_occ ==6 , "Agriculture")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ ==7 , "Craft/Trade")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 8, "Machine Operators")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 9, "Elementary")) %>%
as.data.frame()
View(iv1)
iv1<- clean %>% select(income, age, age2, school, gender, tertiary, race, mother_occ) %>% filter(income >0 & age>0 & school>=0 & tertiary>=0 & mother_occ >=0 & race<= 4 & race >=1) %>%
mutate(income = replace(income, income > 0, log(income))) %>%
mutate(school = replace(school, school >=0, school +1)) %>%
mutate(school = replace(school, school ==26, 0)) %>%
mutate(tertiary = replace(tertiary, tertiary >1, 0)) %>%
mutate(education = school + tertiary) %>%
mutate(gender = replace(gender, gender == 2, "Female")) %>%
mutate(gender = replace(gender, gender == 1, "Male")) %>%
mutate(race = replace(race, race == 1, "African")) %>% mutate(race = replace(race, race == 2, "Coloured")) %>%
mutate(race = replace(race, race == 3, "Asian/Indian")) %>% mutate(race = replace(race, race == 4, "White")) %>%
filter(education >=0 & education <=14) %>%
filter(mother_occ <10) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 1, "Legislators/Managers")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 2, "Professionals")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 3, "Technicians & Associate Professionals")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 4, "Clerks")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 5, "Service Workers")) %>% mutate(mother_occ = replace(mother_occ, mother_occ ==6 , "Agriculture")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ ==7 , "Craft/Trade")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 8, "Machine Operators")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 9, "Elementary")) %>%
as.data.frame()
source("code/basic_clean.R")
clean <- basic_clean(data)
iv1<- clean %>% select(income, age, age2, school, gender, tertiary, race, mother_occ) %>% filter(income >0 & age>0 & school>=0 & tertiary>=0 & mother_occ >=0 & race<= 4 & race >=1) %>%
mutate(income = replace(income, income > 0, log(income))) %>%
mutate(school = replace(school, school >=0, school +1)) %>%
mutate(school = replace(school, school ==26, 0)) %>%
mutate(tertiary = replace(tertiary, tertiary >1, 0)) %>%
mutate(education = school + tertiary) %>%
mutate(gender = replace(gender, gender == 2, "Female")) %>%
mutate(gender = replace(gender, gender == 1, "Male")) %>%
mutate(race = replace(race, race == 1, "African")) %>% mutate(race = replace(race, race == 2, "Coloured")) %>%
mutate(race = replace(race, race == 3, "Asian/Indian")) %>% mutate(race = replace(race, race == 4, "White")) %>%
filter(education >=0 & education <=14) %>%
filter(mother_occ <10) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 1, "Legislators/Managers")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 2, "Professionals")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 3, "Technicians & Associate Professionals")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 4, "Clerks")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 5, "Service Workers")) %>% mutate(mother_occ = replace(mother_occ, mother_occ ==6 , "Agriculture")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ ==7 , "Craft/Trade")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 8, "Machine Operators")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 9, "Elementary")) %>%
as.data.frame()
View(iv1)
clean <- basic_clean(data)
iv1<- clean %>% select(income, age, age2, school, gender, tertiary, race, mother_occ) %>% filter(income >0 & age>0 & school>=0 & tertiary>=0 & mother_occ >=0 & race<= 4 & race >=1) %>%
mutate(income = replace(income, income > 0, log(income))) %>%
mutate(school = replace(school, school >=0, school +1)) %>%
mutate(school = replace(school, school ==26, 0)) %>%
mutate(tertiary = replace(tertiary, tertiary >1, 0)) %>%
mutate(education = school + tertiary) %>%
mutate(gender = replace(gender, gender == 2, "Female")) %>%
mutate(gender = replace(gender, gender == 1, "Male")) %>%
mutate(race = replace(race, race == 1, "African")) %>% mutate(race = replace(race, race == 2, "Coloured")) %>%
mutate(race = replace(race, race == 3, "Asian/Indian")) %>% mutate(race = replace(race, race == 4, "White")) %>%
filter(education >=0 & education <=14) %>%
filter(mother_occ <10) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 1, "Legislator/Manager")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 2, "Professional")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 3, "Technician")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 4, "Clerk")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 5, "Service Worker")) %>% mutate(mother_occ = replace(mother_occ, mother_occ ==6 , "Agriculture")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ ==7 , "Craft/Trade")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 8, "Machine Operator")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 9, "Elementary")) %>%
as.data.frame()
View(iv1)
list.files('code/', full.names = T, recursive = T) %>% as.list() %>% walk(~source(.))
dfiv <- mother_occ(data)
list.files('code/', full.names = T, recursive = T) %>% as.list() %>% walk(~source(.))
dfiv <- mother_occ(data)
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, fig.width = 6, fig.height = 5, fig.pos="H", fig.pos = 'H')
if(!require("tidyverse")) install.packages("tidyverse")
library(tidyverse)
data <- read_dta("data/Adult_W5_Anon_V1.0.0.dta")
list.files('code/', full.names = T, recursive = T) %>% as.list() %>% walk(~source(.))
dfiv <- mother_occ(data)
dfiv <- mother_occ(data)
# lm1 <-lm(income ~ age+ age2+ school + tertiary, dfiv)
# lm2 <-lm(income ~ age+ age2+ school+tertiary + race + gender, dfiv)
lm1 <-lm(income ~ age+ age2+ education, dfiv)
# lm1 <-lm(income ~ age+ age2+ school + tertiary, dfiv)
# lm2 <-lm(income ~ age+ age2+ school+tertiary + race + gender, dfiv)
lm1 <-lm(income ~ age+ age2+ education, dfiv)
lm2 <-lm(income ~ age+ age2+ education + race + gender, dfiv)
#iv1 <- ivreg(income ~ age + age2 | school + tertiary | mother_schl + mother_tert, data = dfiv)
iv1 <- ivreg(income ~ age + age2 | education | mother_occ, data = dfiv)
iv2 <- ivreg(income ~ age + age2 + race + gender| education | mother_occ, data = dfiv)
htab <-
huxreg("OLS 1" = lm1, "2SLS 1" = iv1, "OLS 2" = lm2, "2SLS 2" = iv2,
statistics = c(N = "nobs", R2 = "r.squared"),
note = "%stars%.") %>%
set_caption(Title) %>%
set_label(Label)
htab
