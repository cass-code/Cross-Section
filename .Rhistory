mutate(race = replace(race, race == 1, "African")) %>% mutate(race = replace(race, race == 2, "Coloured")) %>%
mutate(race = replace(race, race == 3, "Asian/Indian")) %>% mutate(race = replace(race, race == 4, "White")) %>%
filter(education >=0 & education <=18) %>%  as.data.frame()
iv1<- clean %>% select(income, age, age2, school, gender, tertiary, race, mother_schl, mother_tert, mother_terlvl, ter) %>% filter(income >0 & age>0 & school>=0 & tertiary>=0 & mother_schl >=0 & mother_tert >=0 & race<= 4 & race >=1) %>%
mutate(mother_terlvl = replace_na(mother_terlvl, 0)) %>%
mutate(ter = replace_na(ter, 0)) %>%
mutate(income = replace(income, income > 0, log(income))) %>%
mutate(school = replace(school, school >=0, school +1)) %>%
mutate(school = replace(school, school ==26, 0)) %>%
mutate(mother_schl = replace(mother_schl, mother_schl >=0, mother_schl +1)) %>%
mutate(mother_schl = replace(mother_schl, mother_schl ==26, 0)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl >=16 & mother_terlvl<=19 | mother_terlvl ==30 | mother_terlvl ==31 | mother_terlvl ==27 | mother_terlvl ==28, 1)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==20 | mother_terlvl ==29 | mother_terlvl ==32, 3)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==21 | mother_terlvl ==22 | mother_terlvl ==33 | mother_terlvl ==34, 4)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==23 | mother_terlvl ==35, 5)) %>%
mutate(ter = replace(ter, ter >=16 & ter<=19 | ter ==30 | ter ==31 | ter ==27 | ter ==28, 1)) %>%
mutate(ter = replace(ter, ter ==20 | ter ==29 | ter ==32, 3)) %>%
mutate(ter = replace(ter, ter ==21 | ter ==22 | ter ==33 | ter ==34, 4)) %>%
mutate(ter = replace(ter, ter ==23 | ter ==35, 5)) %>%
mutate(education = school + ter) %>%
mutate(gender = replace(gender, gender == 2, "Female")) %>%
mutate(gender = replace(gender, gender == 1, "Male")) %>%
mutate(mother_ed = mother_schl + mother_tertlvl) %>%
mutate(race = replace(race, race == 1, "African")) %>% mutate(race = replace(race, race == 2, "Coloured")) %>%
mutate(race = replace(race, race == 3, "Asian/Indian")) %>% mutate(race = replace(race, race == 4, "White")) %>%
filter(education >=0 & education <=18) %>%  as.data.frame()
iv1<- clean %>% select(income, age, age2, school, gender, tertiary, race, mother_schl, mother_tert, mother_terlvl, ter) %>% filter(income >0 & age>0 & school>=0 & tertiary>=0 & mother_schl >=0 & mother_tert >=0 & race<= 4 & race >=1) %>%
mutate(mother_terlvl = replace_na(mother_terlvl, 0)) %>%
mutate(ter = replace_na(ter, 0)) %>%
mutate(income = replace(income, income > 0, log(income))) %>%
mutate(school = replace(school, school >=0, school +1)) %>%
mutate(school = replace(school, school ==26, 0)) %>%
mutate(mother_schl = replace(mother_schl, mother_schl >=0, mother_schl +1)) %>%
mutate(mother_schl = replace(mother_schl, mother_schl ==26, 0)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl >=16 & mother_terlvl<=19 | mother_terlvl ==30 | mother_terlvl ==31 | mother_terlvl ==27 | mother_terlvl ==28, 1)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==20 | mother_terlvl ==29 | mother_terlvl ==32, 3)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==21 | mother_terlvl ==22 | mother_terlvl ==33 | mother_terlvl ==34, 4)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==23 | mother_terlvl ==35, 5)) %>%
mutate(ter = replace(ter, ter >=16 & ter<=19 | ter ==30 | ter ==31 | ter ==27 | ter ==28, 1)) %>%
mutate(ter = replace(ter, ter ==20 | ter ==29 | ter ==32, 3)) %>%
mutate(ter = replace(ter, ter ==21 | ter ==22 | ter ==33 | ter ==34, 4)) %>%
mutate(ter = replace(ter, ter ==23 | ter ==35, 5)) %>%
mutate(education = school + ter) %>%
mutate(gender = replace(gender, gender == 2, "Female")) %>%
mutate(gender = replace(gender, gender == 1, "Male")) %>%
mutate(mother_ed = mother_schl + mother_terlvl) %>%
mutate(race = replace(race, race == 1, "African")) %>% mutate(race = replace(race, race == 2, "Coloured")) %>%
mutate(race = replace(race, race == 3, "Asian/Indian")) %>% mutate(race = replace(race, race == 4, "White")) %>%
filter(education >=0 & education <=18) %>%  as.data.frame()
View(clean)
View(iv1)
cor(iv1$education, iv1$mother_ed, method = "pearson")
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, fig.width = 6, fig.height = 5, fig.pos="H", fig.pos = 'H')
if(!require("tidyverse")) install.packages("tidyverse")
library(tidyverse)
data <- read_dta("data/Adult_W5_Anon_V1.0.0.dta")
library(haven)
list.files('code/', full.names = T, recursive = T) %>% as.list() %>% walk(~source(.))
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, fig.width = 6, fig.height = 5, fig.pos="H", fig.pos = 'H')
if(!require("tidyverse")) install.packages("tidyverse")
library(tidyverse)
library(haven)
library(ivreg)
library(ggplot2)
#read in nids
data <- read_dta("data/Adult_W5_Anon_V1.0.0.dta")
dfiv <- iv_mother(data)
# lm1 <-lm(income ~ age+ age2+ school + tertiary, dfiv)
# lm2 <-lm(income ~ age+ age2+ school+tertiary + race + gender, dfiv)
lm1 <-lm(income ~ age+ age2+ education, dfiv)
lm2 <-lm(income ~ age+ age2+ education + race + gender, dfiv)
#iv1 <- ivreg(income ~ age + age2 | school + tertiary | mother_schl + mother_tert, data = dfiv)
iv1 <- ivreg(income ~ age + age2 | education | mother_ed, data = dfiv)
iv2 <- ivreg(income ~ age + age2 + race + gender| education | mother_ed, data = dfiv)
library(huxtable)
Title <- "Regressions: Mother Education Instrument"
Label <- "reg2"
htab <-
huxreg("OLS 1" = lm1, "2SLS 1" = iv1, "OLS 2" = lm2, "2SLS 2" = iv2,
statistics = c(N = "nobs", R2 = "r.squared"),
note = "%stars%.") %>%
set_caption(Title) %>%
set_label(Label)
htab
clean <- basic_clean(data)
iv1<- clean %>% select(income, age, age2, school, gender, tertiary, race, mother_schl, mother_tert, mother_terlvl, ter) %>% filter(income >0 & age>0 & school>=0 & tertiary>=0 & mother_schl >=0 & mother_tert >=0 & race<= 4 & race >=1) %>%
mutate(mother_terlvl = replace_na(mother_terlvl, 0)) %>%
mutate(ter = replace_na(ter, 0)) %>%
mutate(income = replace(income, income > 0, log(income))) %>%
mutate(school = replace(school, school >=0, school +1)) %>%
mutate(school = replace(school, school ==26, 0)) %>%
mutate(mother_schl = replace(mother_schl, mother_schl >=0, mother_schl +1)) %>%
mutate(mother_schl = replace(mother_schl, mother_schl ==26, 0)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl >=16 & mother_terlvl<=19 | mother_terlvl ==30 | mother_terlvl ==31 | mother_terlvl ==27 | mother_terlvl ==28, 1)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==20 | mother_terlvl ==29 | mother_terlvl ==32, 3)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==21 | mother_terlvl ==22 | mother_terlvl ==33 | mother_terlvl ==34, 4)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==23 | mother_terlvl ==35, 5)) %>%
mutate(ter = replace(ter, ter >=16 & ter<=19 | ter ==30 | ter ==31 | ter ==27 | ter ==28, 1)) %>%
mutate(ter = replace(ter, ter ==20 | ter ==29 | ter ==32, 3)) %>%
mutate(ter = replace(ter, ter ==21 | ter ==22 | ter ==33 | ter ==34, 4)) %>%
mutate(ter = replace(ter, ter ==23 | ter ==35, 5)) %>%
mutate(education = school + ter) %>%
mutate(gender = replace(gender, gender == 2, "Female")) %>%
mutate(gender = replace(gender, gender == 1, "Male")) %>%
mutate(mother_ed = mother_schl + mother_terlvl) %>%
mutate(race = replace(race, race == 1, "African")) %>% mutate(race = replace(race, race == 2, "Coloured")) %>%
mutate(race = replace(race, race == 3, "Asian/Indian")) %>% mutate(race = replace(race, race == 4, "White")) %>%
filter(education >=0 & education <=18) %>%  as.data.frame()
View(iv1)
iv1<- clean %>% select(income, age, age2, school, ter, gender, tertiary, race, mother_schl, mother_tert, mother_terlvl) %>% filter(income >0 & age>0 & school>=0 & tertiary>=0 & mother_schl >=0 & mother_tert >=0 & race<= 4 & race >=1) %>%
mutate(mother_terlvl = replace_na(mother_terlvl, 0)) %>%
mutate(ter = replace_na(ter, 0)) %>%
mutate(income = replace(income, income > 0, log(income))) %>%
mutate(school = replace(school, school >=0, school +1)) %>%
mutate(school = replace(school, school ==26, 0)) %>%
mutate(mother_schl = replace(mother_schl, mother_schl >=0, mother_schl +1)) %>%
mutate(mother_schl = replace(mother_schl, mother_schl ==26, 0)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl >=16 & mother_terlvl<=19 | mother_terlvl ==30 | mother_terlvl ==31 | mother_terlvl ==27 | mother_terlvl ==28, 1)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==20 | mother_terlvl ==29 | mother_terlvl ==32, 3)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==21 | mother_terlvl ==22 | mother_terlvl ==33 | mother_terlvl ==34, 4)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==23 | mother_terlvl ==35, 5)) %>%
mutate(ter = replace(ter, ter >=16 & ter<=19 | ter ==30 | ter ==31 | ter ==27 | ter ==28, 1)) %>%
mutate(ter = replace(ter, ter ==20 | ter ==29 | ter ==32, 3)) %>%
mutate(ter = replace(ter, ter ==21 | ter ==22 | ter ==33 | ter ==34, 4)) %>%
mutate(ter = replace(ter, ter ==23 | ter ==35, 5)) %>%
mutate(education = school + ter) %>%
mutate(gender = replace(gender, gender == 2, "Female")) %>%
mutate(gender = replace(gender, gender == 1, "Male")) %>%
mutate(mother_ed = mother_schl + mother_terlvl) %>%
mutate(race = replace(race, race == 1, "African")) %>% mutate(race = replace(race, race == 2, "Coloured")) %>%
mutate(race = replace(race, race == 3, "Asian/Indian")) %>% mutate(race = replace(race, race == 4, "White")) %>%
filter(education >=0 & education <=18) %>%  as.data.frame()
View(iv1)
clean <- basic_clean(data)
iv1<- clean %>% select(income, age, age2, school, ter, gender, tertiary, race, mother_schl, mother_terlvl, mother_tert) %>% filter(income >0 & age>0 & school>=0 & tertiary>=0 & mother_schl >=0 & mother_tert >=0 & race<= 4 & race >=1) %>%
mutate(mother_terlvl = replace_na(mother_terlvl, 0)) %>%
mutate(ter = replace_na(ter, 0)) %>%
mutate(income = replace(income, income > 0, log(income))) %>%
mutate(school = replace(school, school >=0, school +1)) %>%
mutate(school = replace(school, school ==26, 0)) %>%
mutate(mother_schl = replace(mother_schl, mother_schl >=0, mother_schl +1)) %>%
mutate(mother_schl = replace(mother_schl, mother_schl ==26, 0)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl >=16 & mother_terlvl<=19 | mother_terlvl ==30 | mother_terlvl ==31 | mother_terlvl ==27 | mother_terlvl ==28, 1)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==20 | mother_terlvl ==29 | mother_terlvl ==32, 3)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==21 | mother_terlvl ==22 | mother_terlvl ==33 | mother_terlvl ==34, 4)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==23 | mother_terlvl ==35, 5)) %>%
mutate(ter = replace(ter, ter >=16 & ter<=19 | ter ==30 | ter ==31 | ter ==27 | ter ==28, 1)) %>%
mutate(ter = replace(ter, ter ==20 | ter ==29 | ter ==32, 3)) %>%
mutate(ter = replace(ter, ter ==21 | ter ==22 | ter ==33 | ter ==34, 4)) %>%
mutate(ter = replace(ter, ter ==23 | ter ==35, 5)) %>%
mutate(education = school + ter) %>%
mutate(gender = replace(gender, gender == 2, "Female")) %>%
mutate(gender = replace(gender, gender == 1, "Male")) %>%
mutate(mother_ed = mother_schl + mother_terlvl) %>%
mutate(race = replace(race, race == 1, "African")) %>% mutate(race = replace(race, race == 2, "Coloured")) %>%
mutate(race = replace(race, race == 3, "Asian/Indian")) %>% mutate(race = replace(race, race == 4, "White")) %>%
filter(education >=0 & education <=18) %>%  as.data.frame()
View(iv1)
source("code/basic_clean.R")
clean <- basic_clean(data)
occ<- clean %>% select(income, age, age2, school, gender, tertiary, race, mother_occ) %>% filter(income >0 & age>0 & school>=0 & tertiary>=0 & mother_occ >=0 & race<= 4 & race >=1) %>%
iv1<- clean %>% select(income, age, age2, school, ter, gender, tertiary, race, mother_schl, mother_terlvl, mother_tert) %>% filter(income >0 & age>0 & school>=0 & tertiary>=0 & mother_schl >=0 & mother_tert >=0 & race<= 4 & race >=1) %>%
mutate(mother_terlvl = replace_na(mother_terlvl, 0)) %>%
mutate(ter = replace_na(ter, 0)) %>%
mutate(income = replace(income, income > 0, log(income))) %>%
mutate(school = replace(school, school >=0, school +1)) %>%
mutate(school = replace(school, school ==26, 0)) %>%
mutate(mother_schl = replace(mother_schl, mother_schl >=0, mother_schl +1)) %>%
mutate(mother_schl = replace(mother_schl, mother_schl ==26, 0)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl >=16 & mother_terlvl<=19 | mother_terlvl ==30 | mother_terlvl ==31 | mother_terlvl ==27 | mother_terlvl ==28, 1)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==20 | mother_terlvl ==29 | mother_terlvl ==32, 3)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==21 | mother_terlvl ==22 | mother_terlvl ==33 | mother_terlvl ==34, 4)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==23 | mother_terlvl ==35, 5)) %>%
mutate(ter = replace(ter, ter >=16 & ter<=19 | ter ==30 | ter ==31 | ter ==27 | ter ==28, 1)) %>%
mutate(ter = replace(ter, ter ==20 | ter ==29 | ter ==32, 3)) %>%
mutate(ter = replace(ter, ter ==21 | ter ==22 | ter ==33 | ter ==34, 4)) %>%
mutate(ter = replace(ter, ter ==23 | ter ==35, 5)) %>%
mutate(education = school + ter) %>%
mutate(gender = replace(gender, gender == 2, "Female")) %>%
mutate(gender = replace(gender, gender == 1, "Male")) %>%
mutate(mother_ed = mother_schl + mother_terlvl) %>%
mutate(race = replace(race, race == 1, "African")) %>% mutate(race = replace(race, race == 2, "Coloured")) %>%
mutate(race = replace(race, race == 3, "Asian/Indian")) %>% mutate(race = replace(race, race == 4, "White")) %>%
filter(education >=0 & education <=18) %>%
filter(mother_occ <10) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 1, "Legislator/Manager")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 2, "Professional")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 3, "Technician")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 4, "Clerk")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 5, "Service Worker")) %>% mutate(mother_occ = replace(mother_occ, mother_occ ==6 , "Agriculture")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ ==7 , "Craft/Trade")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 8, "Machine Operator")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 9, "Elementary")) %>%
as.data.frame()
source("code/basic_clean.R")
library(tidyverse)
clean <- basic_clean(data)
occ<- clean %>% select(income, age, age2, school, gender, tertiary, race, mother_occ) %>% filter(income >0 & age>0 & school>=0 & tertiary>=0 & mother_occ >=0 & race<= 4 & race >=1) %>%
iv1<- clean %>% select(income, age, age2, school, ter, gender, tertiary, race, mother_schl, mother_terlvl, mother_tert) %>% filter(income >0 & age>0 & school>=0 & tertiary>=0 & mother_schl >=0 & mother_tert >=0 & race<= 4 & race >=1) %>%
mutate(mother_terlvl = replace_na(mother_terlvl, 0)) %>%
mutate(ter = replace_na(ter, 0)) %>%
mutate(income = replace(income, income > 0, log(income))) %>%
mutate(school = replace(school, school >=0, school +1)) %>%
mutate(school = replace(school, school ==26, 0)) %>%
mutate(mother_schl = replace(mother_schl, mother_schl >=0, mother_schl +1)) %>%
mutate(mother_schl = replace(mother_schl, mother_schl ==26, 0)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl >=16 & mother_terlvl<=19 | mother_terlvl ==30 | mother_terlvl ==31 | mother_terlvl ==27 | mother_terlvl ==28, 1)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==20 | mother_terlvl ==29 | mother_terlvl ==32, 3)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==21 | mother_terlvl ==22 | mother_terlvl ==33 | mother_terlvl ==34, 4)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==23 | mother_terlvl ==35, 5)) %>%
mutate(ter = replace(ter, ter >=16 & ter<=19 | ter ==30 | ter ==31 | ter ==27 | ter ==28, 1)) %>%
mutate(ter = replace(ter, ter ==20 | ter ==29 | ter ==32, 3)) %>%
mutate(ter = replace(ter, ter ==21 | ter ==22 | ter ==33 | ter ==34, 4)) %>%
mutate(ter = replace(ter, ter ==23 | ter ==35, 5)) %>%
mutate(education = school + ter) %>%
mutate(gender = replace(gender, gender == 2, "Female")) %>%
mutate(gender = replace(gender, gender == 1, "Male")) %>%
mutate(mother_ed = mother_schl + mother_terlvl) %>%
mutate(race = replace(race, race == 1, "African")) %>% mutate(race = replace(race, race == 2, "Coloured")) %>%
mutate(race = replace(race, race == 3, "Asian/Indian")) %>% mutate(race = replace(race, race == 4, "White")) %>%
filter(education >=0 & education <=18) %>%
filter(mother_occ <10) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 1, "Legislator/Manager")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 2, "Professional")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 3, "Technician")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 4, "Clerk")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 5, "Service Worker")) %>% mutate(mother_occ = replace(mother_occ, mother_occ ==6 , "Agriculture")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ ==7 , "Craft/Trade")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 8, "Machine Operator")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 9, "Elementary")) %>%
as.data.frame()
clean <- basic_clean(data)
occ<- clean %>% select(income, age, age2, school, gender, tertiary, race, mother_occ) %>% filter(income >0 & age>0 & school>=0 & tertiary>=0 & mother_occ >=0 & mother_occ<10 & race<= 4 & race >=1) %>%
iv1<- clean %>% select(income, age, age2, school, ter, gender, tertiary, race, mother_schl, mother_terlvl, mother_tert) %>% filter(income >0 & age>0 & school>=0 & tertiary>=0 & mother_schl >=0 & mother_tert >=0 & race<= 4 & race >=1) %>%
mutate(mother_terlvl = replace_na(mother_terlvl, 0)) %>%
mutate(ter = replace_na(ter, 0)) %>%
mutate(income = replace(income, income > 0, log(income))) %>%
mutate(school = replace(school, school >=0, school +1)) %>%
mutate(school = replace(school, school ==26, 0)) %>%
mutate(mother_schl = replace(mother_schl, mother_schl >=0, mother_schl +1)) %>%
mutate(mother_schl = replace(mother_schl, mother_schl ==26, 0)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl >=16 & mother_terlvl<=19 | mother_terlvl ==30 | mother_terlvl ==31 | mother_terlvl ==27 | mother_terlvl ==28, 1)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==20 | mother_terlvl ==29 | mother_terlvl ==32, 3)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==21 | mother_terlvl ==22 | mother_terlvl ==33 | mother_terlvl ==34, 4)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==23 | mother_terlvl ==35, 5)) %>%
mutate(ter = replace(ter, ter >=16 & ter<=19 | ter ==30 | ter ==31 | ter ==27 | ter ==28, 1)) %>%
mutate(ter = replace(ter, ter ==20 | ter ==29 | ter ==32, 3)) %>%
mutate(ter = replace(ter, ter ==21 | ter ==22 | ter ==33 | ter ==34, 4)) %>%
mutate(ter = replace(ter, ter ==23 | ter ==35, 5)) %>%
mutate(education = school + ter) %>%
mutate(gender = replace(gender, gender == 2, "Female")) %>%
mutate(gender = replace(gender, gender == 1, "Male")) %>%
mutate(mother_ed = mother_schl + mother_terlvl) %>%
mutate(race = replace(race, race == 1, "African")) %>% mutate(race = replace(race, race == 2, "Coloured")) %>%
mutate(race = replace(race, race == 3, "Asian/Indian")) %>% mutate(race = replace(race, race == 4, "White")) %>%
filter(education >=0 & education <=18) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 1, "Legislator/Manager")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 2, "Professional")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 3, "Technician")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 4, "Clerk")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 5, "Service Worker")) %>% mutate(mother_occ = replace(mother_occ, mother_occ ==6 , "Agriculture")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ ==7 , "Craft/Trade")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 8, "Machine Operator")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 9, "Elementary")) %>%
as.data.frame()
clean <- basic_clean(data)
occ<- clean %>% select(income, age, age2, school, ter, gender, tertiary, race, mother_schl, mother_terlvl, mother_tert, mother_occ) %>%
filter(income >0 & age>0 & school>=0 & tertiary>=0 & mother_schl >=0 & mother_tert >=0 & race<= 4 & race >=1 & mother_occ >=0 & mother_occ<10) %>%
mutate(mother_terlvl = replace_na(mother_terlvl, 0)) %>%
mutate(ter = replace_na(ter, 0)) %>%
mutate(income = replace(income, income > 0, log(income))) %>%
mutate(school = replace(school, school >=0, school +1)) %>%
mutate(school = replace(school, school ==26, 0)) %>%
mutate(mother_schl = replace(mother_schl, mother_schl >=0, mother_schl +1)) %>%
mutate(mother_schl = replace(mother_schl, mother_schl ==26, 0)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl >=16 & mother_terlvl<=19 | mother_terlvl ==30 | mother_terlvl ==31 | mother_terlvl ==27 | mother_terlvl ==28, 1)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==20 | mother_terlvl ==29 | mother_terlvl ==32, 3)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==21 | mother_terlvl ==22 | mother_terlvl ==33 | mother_terlvl ==34, 4)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==23 | mother_terlvl ==35, 5)) %>%
mutate(ter = replace(ter, ter >=16 & ter<=19 | ter ==30 | ter ==31 | ter ==27 | ter ==28, 1)) %>%
mutate(ter = replace(ter, ter ==20 | ter ==29 | ter ==32, 3)) %>%
mutate(ter = replace(ter, ter ==21 | ter ==22 | ter ==33 | ter ==34, 4)) %>%
mutate(ter = replace(ter, ter ==23 | ter ==35, 5)) %>%
mutate(education = school + ter) %>%
mutate(gender = replace(gender, gender == 2, "Female")) %>%
mutate(gender = replace(gender, gender == 1, "Male")) %>%
mutate(mother_ed = mother_schl + mother_terlvl) %>%
mutate(race = replace(race, race == 1, "African")) %>% mutate(race = replace(race, race == 2, "Coloured")) %>%
mutate(race = replace(race, race == 3, "Asian/Indian")) %>% mutate(race = replace(race, race == 4, "White")) %>%
filter(education >=0 & education <=18) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 1, "Legislator/Manager")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 2, "Professional")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 3, "Technician")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 4, "Clerk")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 5, "Service Worker")) %>% mutate(mother_occ = replace(mother_occ, mother_occ ==6 , "Agriculture")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ ==7 , "Craft/Trade")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 8, "Machine Operator")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 9, "Elementary")) %>%
as.data.frame()
View(occ)
source("code/basic_clean.R")
clean <- basic_clean(data)
occ<- clean %>% select(income, age, age2, school, ter, gender, tertiary, race, mother_schl, mother_terlvl, mother_occ) %>%
filter(income >0 & age>0 & school>=0 & tertiary>=0 & mother_schl >=0 & race<= 4 & race >=1 & mother_occ >=0 & mother_occ<10) %>%
mutate(mother_terlvl = replace_na(mother_terlvl, 0)) %>%
mutate(ter = replace_na(ter, 0)) %>%
mutate(income = replace(income, income > 0, log(income))) %>%
mutate(school = replace(school, school >=0, school +1)) %>%
mutate(school = replace(school, school ==26, 0)) %>%
mutate(mother_schl = replace(mother_schl, mother_schl >=0, mother_schl +1)) %>%
mutate(mother_schl = replace(mother_schl, mother_schl ==26, 0)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl >=16 & mother_terlvl<=19 | mother_terlvl ==30 | mother_terlvl ==31 | mother_terlvl ==27 | mother_terlvl ==28, 1)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==20 | mother_terlvl ==29 | mother_terlvl ==32, 3)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==21 | mother_terlvl ==22 | mother_terlvl ==33 | mother_terlvl ==34, 4)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==23 | mother_terlvl ==35, 5)) %>%
mutate(ter = replace(ter, ter >=16 & ter<=19 | ter ==30 | ter ==31 | ter ==27 | ter ==28, 1)) %>%
mutate(ter = replace(ter, ter ==20 | ter ==29 | ter ==32, 3)) %>%
mutate(ter = replace(ter, ter ==21 | ter ==22 | ter ==33 | ter ==34, 4)) %>%
mutate(ter = replace(ter, ter ==23 | ter ==35, 5)) %>%
mutate(education = school + ter) %>%
mutate(gender = replace(gender, gender == 2, "Female")) %>%
mutate(gender = replace(gender, gender == 1, "Male")) %>%
mutate(mother_ed = mother_schl + mother_terlvl) %>%
mutate(race = replace(race, race == 1, "African")) %>% mutate(race = replace(race, race == 2, "Coloured")) %>%
mutate(race = replace(race, race == 3, "Asian/Indian")) %>% mutate(race = replace(race, race == 4, "White")) %>%
filter(education >=0 & education <=18) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 1, "Legislator/Manager")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 2, "Professional")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 3, "Technician")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 4, "Clerk")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 5, "Service Worker")) %>% mutate(mother_occ = replace(mother_occ, mother_occ ==6 , "Agriculture")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ ==7 , "Craft/Trade")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 8, "Machine Operator")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 9, "Elementary")) %>%
as.data.frame()
View(occ)
list.files('code/', full.names = T, recursive = T) %>% as.list() %>% walk(~source(.))
dfiv <- mother_occ(data)
# lm1 <-lm(income ~ age+ age2+ school + tertiary, dfiv)
# lm2 <-lm(income ~ age+ age2+ school+tertiary + race + gender, dfiv)
lm1 <-lm(income ~ age+ age2+ education, dfiv)
lm2 <-lm(income ~ age+ age2+ education + race + gender, dfiv)
iv1 <- ivreg(income ~ age + age2 | education | mother_occ, data = dfiv)
iv2 <- ivreg(income ~ age + age2 + race + gender| education | mother_occ, data = dfiv)
Title <- "Regressions: Mother's Occupation as Instrument"
Label <- "reg3"
htab <-
huxreg("OLS 1" = lm1, "2SLS 1" = iv1, "OLS 2" = lm2, "2SLS 2" = iv2,
statistics = c(N = "nobs", R2 = "r.squared"),
note = "%stars%.") %>%
set_caption(Title) %>%
set_label(Label)
font_size(htab) <- 12
htab
iv2 <- ivreg(income ~ age + age2 + race + gender| education | mother_occ, data = dfiv)
iv2
summary(iv2)
View(iv2)
list.files('code/', full.names = T, recursive = T) %>% as.list() %>% walk(~source(.))
dfiv <- iv_mother(data)
lm1 <-lm(income ~ age+ age2+ education, dfiv)
lm2 <-lm(income ~ age+ age2+ education + race + gender, dfiv)
iv1 <- ivreg(income ~ age + age2 | education | mother_ed, data = dfiv)
iv2 <- ivreg(income ~ age + age2 + race + gender| education | mother_ed, data = dfiv)
library(huxtable)
Title <- "Regressions: Mother Education Instrument"
Label <- "reg2"
htab <-
huxreg("OLS 1" = lm1, "2SLS 1" = iv1, "OLS 2" = lm2, "2SLS 2" = iv2,
coefs = c("Coloured" = "raceColoured", "Asian/Indian" = "raceAsian/Indian", "White" = "raceWhite", "Male" = "genderMale" ),
statistics = c(N = "nobs", R2 = "r.squared"),
note = "%stars%.") %>%
set_caption(Title) %>%
set_label(Label)
font_size(htab) <- 12
htab
htab <-
huxreg("OLS 1" = lm1, "2SLS 1" = iv1, "OLS 2" = lm2, "2SLS 2" = iv2,
coefs = c("age" = "age", "age2" = "age2", "eduation" = "education", "Coloured" = "raceColoured", "Asian/Indian" = "raceAsian/Indian", "White" = "raceWhite", "Male" = "genderMale" ),
statistics = c(N = "nobs", R2 = "r.squared"),
note = "%stars%.") %>%
set_caption(Title) %>%
set_label(Label)
font_size(htab) <- 12
htab
htab <-
huxreg("OLS 1" = lm1, "2SLS 1" = iv1, "OLS 2" = lm2, "2SLS 2" = iv2,
coefs = c("age" = "age", "age2" = "age2", "education" = "education", "Coloured" = "raceColoured", "Asian/Indian" = "raceAsian/Indian", "White" = "raceWhite", "Male" = "genderMale" ),
statistics = c(N = "nobs", R2 = "r.squared"),
note = "%stars%.") %>%
set_caption(Title) %>%
set_label(Label)
font_size(htab) <- 12
htab
iv2 <- ivreg(income ~ age + age2 + race + gender| education | mother_occ + mother_ed, data = dfiv)
iv2 <- ivreg(income ~ age + age2 + race + gender| education | mother_occ, data = dfiv)
dfiv <- mother_occ(data)
iv2 <- ivreg(income ~ age + age2 + race + gender| education | mother_occ+ mother_ed, data = dfiv)
list.files('code/', full.names = T, recursive = T) %>% as.list() %>% walk(~source(.))
data <- read_dta("data/Adult_W5_Anon_V1.0.0.dta")
data <- read_dta("data/Adult_W5_Anon_V1.0.0.dta")
dfiv <- mother_occ(data)
lm1 <-lm(income ~ age+ age2+ education, dfiv)
lm2 <-lm(income ~ age+ age2+ education + race + gender, dfiv)
iv1 <- ivreg(income ~ age + age2 | education | mother_occ +, data = dfiv)
iv1 <- ivreg(income ~ age + age2 | education | mother_occ, data = dfiv)
iv1 <- ivreg(income ~ age + age2 | education | mother_occ + mother_ed, data = dfiv)
View(dfiv)
occ<- clean %>% select(income, age, age2, school, ter, gender, tertiary, race, mother_schl, mother_terlvl, mother_occ) %>%
filter(income >0 & age>0 & school>=0 & tertiary>=0 & mother_schl >=0 & race<= 4 & race >=1 & mother_occ >=0 & mother_occ<10) %>%
mutate(mother_terlvl = replace_na(mother_terlvl, 0)) %>%
mutate(ter = replace_na(ter, 0)) %>%
mutate(income = replace(income, income > 0, log(income))) %>%
mutate(school = replace(school, school >=0, school +1)) %>%
mutate(school = replace(school, school ==26, 0)) %>%
mutate(mother_schl = replace(mother_schl, mother_schl >=0, mother_schl +1)) %>%
mutate(mother_schl = replace(mother_schl, mother_schl ==26, 0)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl >=16 & mother_terlvl<=19 | mother_terlvl ==30 | mother_terlvl ==31 | mother_terlvl ==27 | mother_terlvl ==28, 1)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==20 | mother_terlvl ==29 | mother_terlvl ==32, 3)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==21 | mother_terlvl ==22 | mother_terlvl ==33 | mother_terlvl ==34, 4)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==23 | mother_terlvl ==35, 5)) %>%
mutate(ter = replace(ter, ter >=16 & ter<=19 | ter ==30 | ter ==31 | ter ==27 | ter ==28, 1)) %>%
mutate(ter = replace(ter, ter ==20 | ter ==29 | ter ==32, 3)) %>%
mutate(ter = replace(ter, ter ==21 | ter ==22 | ter ==33 | ter ==34, 4)) %>%
mutate(ter = replace(ter, ter ==23 | ter ==35, 5)) %>%
mutate(education = school + ter) %>%
mutate(gender = replace(gender, gender == 2, "Female")) %>%
mutate(gender = replace(gender, gender == 1, "Male")) %>%
mutate(mother_ed = mother_schl + mother_terlvl) %>%
mutate(race = replace(race, race == 1, "African")) %>% mutate(race = replace(race, race == 2, "Coloured")) %>%
mutate(race = replace(race, race == 3, "Asian/Indian")) %>% mutate(race = replace(race, race == 4, "White")) %>%
filter(education >=0 & education <=18) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 1, "Legislator/Manager")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 2, "Professional")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 3, "Technician")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 4, "Clerk")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 5, "Service Worker")) %>% mutate(mother_occ = replace(mother_occ, mother_occ ==6 , "Agriculture")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ ==7 , "Craft/Trade")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 8, "Machine Operator")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 9, "Elementary")) %>%
as.data.frame()
library(tidyverse)
clean <- basic_clean(data)
occ<- clean %>% select(income, age, age2, school, ter, gender, tertiary, race, mother_schl, mother_terlvl, mother_occ) %>%
filter(income >0 & age>0 & school>=0 & tertiary>=0 & mother_schl >=0 & race<= 4 & race >=1 & mother_occ >=0 & mother_occ<10) %>%
mutate(mother_terlvl = replace_na(mother_terlvl, 0)) %>%
mutate(ter = replace_na(ter, 0)) %>%
mutate(income = replace(income, income > 0, log(income))) %>%
mutate(school = replace(school, school >=0, school +1)) %>%
mutate(school = replace(school, school ==26, 0)) %>%
mutate(mother_schl = replace(mother_schl, mother_schl >=0, mother_schl +1)) %>%
mutate(mother_schl = replace(mother_schl, mother_schl ==26, 0)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl >=16 & mother_terlvl<=19 | mother_terlvl ==30 | mother_terlvl ==31 | mother_terlvl ==27 | mother_terlvl ==28, 1)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==20 | mother_terlvl ==29 | mother_terlvl ==32, 3)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==21 | mother_terlvl ==22 | mother_terlvl ==33 | mother_terlvl ==34, 4)) %>%
mutate(mother_terlvl = replace(mother_terlvl, mother_terlvl ==23 | mother_terlvl ==35, 5)) %>%
mutate(ter = replace(ter, ter >=16 & ter<=19 | ter ==30 | ter ==31 | ter ==27 | ter ==28, 1)) %>%
mutate(ter = replace(ter, ter ==20 | ter ==29 | ter ==32, 3)) %>%
mutate(ter = replace(ter, ter ==21 | ter ==22 | ter ==33 | ter ==34, 4)) %>%
mutate(ter = replace(ter, ter ==23 | ter ==35, 5)) %>%
mutate(education = school + ter) %>%
mutate(gender = replace(gender, gender == 2, "Female")) %>%
mutate(gender = replace(gender, gender == 1, "Male")) %>%
mutate(mother_ed = mother_schl + mother_terlvl) %>%
mutate(race = replace(race, race == 1, "African")) %>% mutate(race = replace(race, race == 2, "Coloured")) %>%
mutate(race = replace(race, race == 3, "Asian/Indian")) %>% mutate(race = replace(race, race == 4, "White")) %>%
filter(education >=0 & education <=18) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 1, "Legislator/Manager")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 2, "Professional")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 3, "Technician")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 4, "Clerk")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 5, "Service Worker")) %>% mutate(mother_occ = replace(mother_occ, mother_occ ==6 , "Agriculture")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ ==7 , "Craft/Trade")) %>% mutate(mother_occ = replace(mother_occ, mother_occ == 8, "Machine Operator")) %>%
mutate(mother_occ = replace(mother_occ, mother_occ == 9, "Elementary")) %>%
as.data.frame()
View(occ)
dfiv <- mother_occ(data)
View(dfiv)
dfiv <- m_occ(data)
lm1 <-lm(income ~ age+ age2+ education, dfiv)
lm2 <-lm(income ~ age+ age2+ education + race + gender, dfiv)
iv1 <- ivreg(income ~ age + age2 | education | mother_occ + mother_ed, data = dfiv)
iv2 <- ivreg(income ~ age + age2 + race + gender| education | mother_occ+ mother_ed, data = dfiv)
summary(iv2)
htab <-
huxreg("OLS 1" = lm1, "2SLS 1" = iv1, "OLS 2" = lm2, "2SLS 2" = iv2,
coefs = c("age" = "age", "age2" = "age2", "education" = "education", "Coloured" = "raceColoured", "Asian/Indian" = "raceAsian/Indian", "White" = "raceWhite", "Male" = "genderMale" ),
statistics = c(N = "nobs", R2 = "r.squared"),
note = "%stars%.") %>%
set_caption(Title) %>%
set_label(Label)
font_size(htab) <- 12
htab
list.files('code/', full.names = T, recursive = T) %>% as.list() %>% walk(~source(.))
dfiv <- iv1_clean(data)
lm1 <-lm(income ~ age+ age2+ school + tertiary, dfiv)
lm2 <-lm(income ~ age+ age2+ school+tertiary + race + gender, dfiv)
dfiv <- iv1_father(data)
list.files('code/', full.names = T, recursive = T) %>% as.list() %>% walk(~source(.))
dfiv <- iv1_father(data)
dfiv <- iv_father(data)
lm2 <-lm(income ~ age+ age2+ education + race + gender, dfiv)
list.files('code/', full.names = T, recursive = T) %>% as.list() %>% walk(~source(.))
d1 <- iv_father(data)
d3 <- f_occ(data)
d3 <- f_occ(data)
d4 <- m_occ(data)
lm1 <-lm(income ~ age+ age2+ education + race + gender, d1)
iv1 <- ivreg(income ~ age + age2 + race + gender| education | father_ed, data = d1)
iv2 <- ivreg(income ~ age + age2 + race + gender| education | mother_ed, data = d2)
iv3 <- ivreg(income ~ age + age2 + race + gender| education | father_occ, data = d3)
d2 <- iv_mother(data)
iv2 <- ivreg(income ~ age + age2 + race + gender| education | mother_ed, data = d2)
iv3 <- ivreg(income ~ age + age2 + race + gender| education | father_occ, data = d3)
iv4 <- ivreg(income ~ age + age2 + race + gender| education | mother_occ, data = d4)
Title <- "Regressions: Father's Education as Instrument"
Label <- "reg1"
htab <-
huxreg("OLS" = lm1, "2SLS FE" = iv1, "2SLS ME" = iv2, "2SLS FO" = iv3, "2SLS MO" = iv4,
coefs = c("age" = "age", "age2" = "age2", "education" = "education", "Coloured" = "raceColoured", "Asian/Indian" = "raceAsian/Indian", "White" = "raceWhite", "Male" = "genderMale" ),
statistics = c(N = "nobs", R2 = "r.squared"),
note = "%stars%.") %>%
set_caption(Title) %>%
set_label(Label)
font_size(htab) <- 12
htab
d4 <- m_occ(data)
lm1 <-lm(income ~ age+ age2+ education + race + gender, d4)
iv1 <- ivreg(income ~ age + age2 + race + gender| education | father_ed, data = d4)
iv2 <- ivreg(income ~ age + age2 + race + gender| education | mother_ed, data = d4)
iv3 <- ivreg(income ~ age + age2 + race + gender| education | father_occ, data = d4)
iv4 <- ivreg(income ~ age + age2 + race + gender| education | mother_occ, data = d4)
